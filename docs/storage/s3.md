# S3 Storage

## Salient features
- 11 9s of durability
- 4 9s of availability, except for one-zone IA (99.5%)
- IA and Glacier tiers ave minimum duration charge. IA - 30 days, Glacier - 90 days, Glacier deep archive - 180 days 
- Typical latency: 100-200 ms
- Performance: Multi-part upload, Transfer acceleration (move to edge, copied to another region privately)

## Anti patterns:
- Lots of small files
- POSIX file system (use EFS instead), file locks
- Search features, queries, rapidly changing data
- Website with dynamic content

## Integrations
- Integrate with Event Bridge for fine-grained filtering & multiple targets

## S3 Select & Glacier Select
- S3 Select, launching in preview now generally available, enables applications to retrieve only a subset of data from an object by using simple SQL expressions. 
- By using S3 Select to retrieve only the data needed by your application, you can achieve drastic performance increases â€“ in many cases you can get as much as a 400% improvement.

- cold data stored in Glacier can now be easily queried within minutes.
- This unlocks a lot of exciting new business value for your archived data. 
- Glacier Select allows you to to perform filtering directly against a Glacier object using standard SQL statements.

> **Glacier Vault with read-only vault lock policy can protect logs from tampering.**

## S3 Cross-Region

> Suitable for dynamic content that needs to be served closer to multi-region consumers. Cloudfront data is cached for a day (typically), so not suitable for dynamic content.

> The cost coming out of CloudFront is typically half a cent less per GB than data transfer for the same tier and Region. 
> What this means is that you can take advantage of the additional performance and security of CloudFront by putting it in front of your Application Load Balancers (ALB), AWS Elastic Beanstalk, Amazon S3, and other AWS resources delivering HTTP(S) objects for next to no additional cost.

> To compare the general upload speed **across Amazon S3 Regions**, you can use the Amazon S3 Transfer Acceleration Speed Comparison tool.

## Block Public Access

### Ignore Public ACLs
- Setting this option to TRUE causes Amazon S3 to ignore all public ACLs on a bucket and any objects that it contains. 
- This setting enables you to **safely block public access granted by ACLs** while still allowing PUT Object calls that include a public ACL (as opposed to BlockPublicAcls, which rejects PUT Object calls that include a public ACL). 
- Enabling this setting doesn't affect the persistence of any existing ACLs and doesn't prevent new public ACLs from being set.

### Block Public ACLs
- PUT Bucket acl and PUT Object acl calls fail if the specified access control list (ACL) is public.
- PUT Object calls fail if the request includes a public ACL.
- If this setting is applied to an account, then PUT Bucket calls fail if the request includes a public ACL.

> This setting enables you to protect against public access while allowing you to audit, refine, or otherwise alter the existing policies and ACLs for your buckets and objects.

### Block Public Policy
- Setting this option to TRUE for a bucket causes Amazon S3 to reject calls to PUT Bucket policy if the specified bucket policy allows public access, and to reject calls to PUT access point policy for all of the bucket's access points if the specified policy allows public access. 
- This setting enables you to allow users to manage access point and bucket policies without allowing them to publicly share the bucket or the objects it contains. Enabling this setting doesn't affect existing access point or bucket policies.

### Restrict Public Buckets
- Setting this option to TRUE restricts access to an access point or bucket with a public policy to only AWS service principals and authorized users within the bucket owner's account. 
- This setting blocks all cross-account access to the access point or bucket (except by AWS service principals), while still allowing users within the account to manage the access point or bucket.
